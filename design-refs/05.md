üß† –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–ø–∞—Ä—Å–∏–Ω–≥–∞ –≤–∞–∫–∞–Ω—Å–∏–π (Job Scraper Engine)

–ü—Ä–æ–µ–∫—Ç: —Å–∞–π—Ç –≤–∞–∫–∞–Ω—Å–∏–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, Vakansiya.AZ)
–¶–µ–ª—å: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Å–±–æ—Ä –∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏—è –≤–∞–∫–∞–Ω—Å–∏–π —Å –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –∞–∑–µ—Ä–±–∞–π–¥–∂–∞–Ω—Å–∫–∏—Ö —Å–∞–π—Ç–æ–≤.

üí° –û–±—â–∞—è –∏–¥–µ—è

–°–∞–π—Ç –¥–æ–ª–∂–µ–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–±–∏—Ä–∞—Ç—å –≤–∞–∫–∞–Ω—Å–∏–∏ —Å –≤–Ω–µ—à–Ω–∏—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä: Boss.az, Jobsearch.az, Tap.az, Rabota.az, HiJob.az, Joblist.az),
–ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤—ã–≤–∞—Ç—å –∏—Ö –≤ –µ–¥–∏–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç, —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –≤ –±–∞–∑—É Supabase,
–∏ –æ–±–Ω–æ–≤–ª—è—Ç—å –±–∞–∑—É –∫–∞–∂–¥—ã–µ 2‚Äì3 —á–∞—Å–∞, –¥–∞–∂–µ –±–µ–∑ —Ä—É—á–Ω—ã—Ö –¥–æ–±–∞–≤–ª–µ–Ω–∏–π.

‚öôÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã
External Sites (boss.az / tap.az / job.az / jobsearch.az)
           ‚Üì
 [Scraper Service (Node.js, Puppeteer/Playwright/Cheerio)]
           ‚Üì
 [POST /api/import-jobs ‚Üí Next.js API]
           ‚Üì
 [AI Agent: Standardizer (—á–µ—Ä–µ–∑ OpenRouter API)]
           ‚Üì
 [Supabase DB ‚Üí vacancies]
           ‚Üì
 (Optional) Telegram/Chat Notification

üß© –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
1. Scraper Engine (Node.js)

–ó–∞–¥–∞—á–∏:

–†–∞–∑ –≤ 1 —á–∞—Å–∞ –æ–±—Ö–æ–¥–∏—Ç —Å–ø–∏—Å–æ–∫ —Å–∞–π—Ç–æ–≤: Boss.az, Jobsearch.az, Tap.az, Rabota.az, HiJob.az, Joblist.az.

–°–æ–±–∏—Ä–∞–µ—Ç –ø–æ–ª—è:

title ‚Äî –Ω–∞–∑–≤–∞–Ω–∏–µ –≤–∞–∫–∞–Ω—Å–∏–∏

company ‚Äî –∫–æ–º–ø–∞–Ω–∏—è

salary ‚Äî –∑–∞—Ä–ø–ª–∞—Ç–∞ (–µ—Å–ª–∏ —É–∫–∞–∑–∞–Ω–∞)

city ‚Äî –≥–æ—Ä–æ–¥

description ‚Äî –æ–ø–∏—Å–∞–Ω–∏–µ

link ‚Äî —Å—Å—ã–ª–∫–∞ –Ω–∞ –æ—Ä–∏–≥–∏–Ω–∞–ª

–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –º–∞—Å—Å–∏–≤ —Å–æ–±—Ä–∞–Ω–Ω—ã—Ö –≤–∞–∫–∞–Ω—Å–∏–π –Ω–∞ —ç–Ω–¥–ø–æ–∏–Ω—Ç:
POST /api/import-jobs

–ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:

Puppeteer –∏–ª–∏ Playwright (–µ—Å–ª–∏ –Ω—É–∂–µ–Ω —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ —Å—Ç—Ä–∞–Ω–∏—Ü—ã)

Cheerio (–µ—Å–ª–∏ HTML –º–æ–∂–Ω–æ –ø—Ä–æ—Å—Ç–æ —Å–ø–∞—Ä—Å–∏—Ç—å)

2. API —ç–Ω–¥–ø–æ–∏–Ω—Ç: /api/import-jobs

–§–∞–π–ª:
app/api/import-jobs/route.ts

import { NextResponse } from 'next/server';
import { createClient } from '@supabase/supabase-js';
import { standardizeVacancy } from '@/lib/aiStandardizer';

const supabase = createClient(process.env.SUPABASE_URL!, process.env.SUPABASE_KEY!);

export async function POST(req: Request) {
  const rawData = await req.json();

  // –ü–µ—Ä–µ–ø–∏—Å—ã–≤–∞–µ–º —á–µ—Ä–µ–∑ AI-–∞–≥–µ–Ω—Ç–∞ (OpenRouter)
  const standardized = await standardizeVacancy(rawData);

  // –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥—É–±–ª–∏–∫–∞—Ç—ã
  const { data: existing } = await supabase
    .from('vacancies')
    .select('id')
    .eq('title', standardized.title)
    .eq('company', standardized.company)
    .eq('city', standardized.city)
    .limit(1);

  if (!existing?.length) {
    await supabase.from('vacancies').insert({
      ...standardized,
      source: rawData.source,
      source_url: rawData.source_url,
      imported_at: new Date(),
      ai_rewritten: true,
      ai_model_used: process.env.OPENROUTER_PRIMARY_MODEL,
    });
  }

  return NextResponse.json({ status: 'ok' });
}

3. AI-–º–æ–¥—É–ª—å —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏–∏ (lib/aiStandardizer.ts)
–¶–µ–ª—å

–ü—Ä–∏–≤–µ—Å—Ç–∏ —Ç–µ–∫—Å—Ç –≤–∞–∫–∞–Ω—Å–∏–∏ –∫ –µ–¥–∏–Ω–æ–º—É –∞–∫–∫—É—Ä–∞—Ç–Ω–æ–º—É –≤–∏–¥—É –Ω–∞ –∞–∑–µ—Ä–±–∞–π–¥–∂–∞–Ω—Å–∫–æ–º —è–∑—ã–∫–µ,
—É–¥–∞–ª–∏—Ç—å —ç–º–æ–¥–∑–∏, –¥—É–±–ª–∏–∫–∞—Ç—ã –∏ –Ω–µ–Ω—É–∂–Ω—ã–π –º—É—Å–æ—Ä.

–í–∞—Ä–∏–∞–Ω—Ç —Å OpenRouter –∏ —Ä–µ–∑–µ—Ä–≤–Ω—ã–º–∏ –º–æ–¥–µ–ª—è–º–∏
import axios from "axios";

export async function standardizeVacancy(rawVacancy) {
  const apiKey = process.env.OPENROUTER_API_KEY;
  const primaryModel = process.env.OPENROUTER_PRIMARY_MODEL || "deepseek/deepseek-chat-v3";
  const backupModel = process.env.OPENROUTER_BACKUP_MODEL || "zhipu/glm-4.5";

  const prompt = `
  S…ôn Az…ôrbaycan i≈ü elanlarƒ± √º√ß√ºn m…ôtn redaktorusan.
  M…ôtnl…ôri qƒ±sa, d√ºzg√ºn v…ô t…ômiz formada yaz.
  Emoji v…ô lazƒ±msƒ±z s√∂zl…ôri sil.
  Format (JSON):
  {
    "title": "",
    "company": "",
    "description": "",
    "salary_min": "",
    "salary_max": "",
    "city": "",
    "category": ""
  }
  `;

  try {
    const response = await axios.post(
      "https://openrouter.ai/api/v1/chat/completions",
      {
        model: primaryModel,
        messages: [
          { role: "system", content: "You are a text standardizer for Azerbaijani job ads." },
          { role: "user", content: prompt + "\n\n" + JSON.stringify(rawVacancy) },
        ],
      },
      { headers: { Authorization: `Bearer ${apiKey}` } }
    );
    return JSON.parse(response.data.choices[0].message.content);
  } catch (err) {
    console.error("Primary model failed, switching to backup:", err.message);

    const response = await axios.post(
      "https://openrouter.ai/api/v1/chat/completions",
      {
        model: backupModel,
        messages: [
          { role: "system", content: "You are a text standardizer for Azerbaijani job ads." },
          { role: "user", content: prompt + "\n\n" + JSON.stringify(rawVacancy) },
        ],
      },
      { headers: { Authorization: `Bearer ${apiKey}` } }
    );
    return JSON.parse(response.data.choices[0].message.content);
  }
}

üß± –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö (Supabase)

–¢–∞–±–ª–∏—Ü–∞: vacancies

–ü–æ–ª–µ	–¢–∏–ø	–û–ø–∏—Å–∞–Ω–∏–µ
id	uuid	PK
title	text	–Ω–∞–∑–≤–∞–Ω–∏–µ –≤–∞–∫–∞–Ω—Å–∏–∏
company	text	–∫–æ–º–ø–∞–Ω–∏—è
description	text	–æ–ø–∏—Å–∞–Ω–∏–µ
salary_min	numeric	–º–∏–Ω. –∑–∞—Ä–ø–ª–∞—Ç–∞
salary_max	numeric	–º–∞–∫—Å. –∑–∞—Ä–ø–ª–∞—Ç–∞
city	text	–≥–æ—Ä–æ–¥
category	text	–∫–∞—Ç–µ–≥–æ—Ä–∏—è
source	text	–∏—Å—Ç–æ—á–Ω–∏–∫ (–Ω–∞–ø—Ä–∏–º–µ—Ä, "boss.az")
source_url	text	—Å—Å—ã–ª–∫–∞ –Ω–∞ –æ—Ä–∏–≥–∏–Ω–∞–ª
imported_at	timestamp	–¥–∞—Ç–∞ –∏–º–ø–æ—Ä—Ç–∞
ai_rewritten	boolean	–±—ã–ª–∞ –ª–∏ –ø–µ—Ä–µ–ø–∏—Å–∞–Ω–∞ –ò–ò
ai_model_used	text	–Ω–∞–∑–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏ (DeepSeek, GLM –∏ —Ç.–¥.)
üïì –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –ø–∞—Ä—Å–∏–Ω–≥–∞

–ü–µ—Ä–∏–æ–¥–∏—á–Ω–æ—Å—Ç—å: –∫–∞–∂–¥—ã–µ 1 —á–∞—Å
–í–∞—Ä–∏–∞–Ω—Ç—ã Cron-–∑–∞–ø—É—Å–∫–∞:




(–∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 10:00, 13:00, 16:00, 19:00, 22:00, 01:00 –ø–æ –ë–∞–∫—É)

üí¨ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)

–ü–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤—ã—Ö –≤–∞–∫–∞–Ω—Å–∏–π –º–æ–∂–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è:

–≤ Telegram-–±–æ—Ç

–≤ WhatsApp-—á–∞—Ç

–≤–æ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π e-—á–∞—Ç
–≥–¥–µ AI-–∞–≥–µ–Ω—Ç —Å–æ–æ–±—â–∞–µ—Ç –æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –Ω–æ–≤—ã—Ö –∏–º–ø–æ—Ä—Ç–æ–≤.

üîå –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å OpenRouter (AI-–∞–≥–µ–Ω—Ç)
–¶–µ–ª—å

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å OpenRouter –∫–∞–∫ —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π —à–ª—é–∑ –∫ –Ω–µ—Å–∫–æ–ª—å–∫–∏–º LLM-–º–æ–¥–µ–ª—è–º –¥–ª—è –∑–∞–¥–∞—á —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏–∏ —Ç–µ–∫—Å—Ç–∞.

–ú–æ–¥–µ–ª–∏
–ù–∞–∑–≤–∞–Ω–∏–µ	–ü—Ä–æ–≤–∞–π–¥–µ—Ä	–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞
deepseek/deepseek-chat-v3	DeepSeek	–±—ã—Å—Ç—Ä–æ –∏ –¥–µ—à–µ–≤–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ç–µ–∫—Å—Ç—ã
zhipu/glm-4.5	Z.AI	–±–æ–ª—å—à–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å, —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –∫ —à—É–º—É
(—Ä–µ–∑–µ—Ä–≤–Ω—ã–µ)	–¥—Ä—É–≥–∏–µ –∏–∑ —Å–ø–∏—Å–∫–∞ OpenRouter	–º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–∏ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–∏
‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –æ–∫—Ä—É–∂–µ–Ω–∏—è (.env)
SUPABASE_URL=...
SUPABASE_KEY=...
OPENROUTER_API_KEY=...

OPENROUTER_PRIMARY_MODEL=deepseek/deepseek-chat-v3
OPENROUTER_BACKUP_MODEL=zhipu/glm-4.5

üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–π —Å–ø–∏—Å–æ–∫ –∏–∑ 10 —Å—Ç–∞—Ä—ã—Ö –≤–∞–∫–∞–Ω—Å–∏–π.

–ü—Ä–æ–≥–Ω–∞—Ç—å –∏—Ö —á–µ—Ä–µ–∑ standardizeVacancy(rawVacancy)

–ü—Ä–æ–≤–µ—Ä–∏—Ç—å:

–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π JSON-–æ—Ç–≤–µ—Ç;

–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –ø–æ–ª—è title/company/city;

—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ Supabase –±–µ–∑ –¥—É–±–ª–µ–π;

–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ ai_model_used.

‚úÖ –†–µ–∑—é–º–µ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞

–ó–∞–¥–∞—á–∞:
–°–æ–∑–¥–∞—Ç—å –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å Scraper Engine, –∫–æ—Ç–æ—Ä—ã–π:

–ø–∞—Ä—Å–∏—Ç –≤–∞–∫–∞–Ω—Å–∏–∏ —Å –∞–∑–µ—Ä–±–∞–π–¥–∂–∞–Ω—Å–∫–∏—Ö —Å–∞–π—Ç–æ–≤;

—á–µ—Ä–µ–∑ AI-–∞–≥–µ–Ω—Ç–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä—É–µ—Ç —Ç–µ–∫—Å—Ç;

—Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ Supabase;

–ø—Ä–æ–≤–µ—Ä—è–µ—Ç –¥—É–±–ª–∏–∫–∞—Ç—ã (title + company + city);

–¥–æ–±–∞–≤–ª—è–µ—Ç –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ (source, source_url, imported_at, ai_model_used);

—Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∂–¥—ã–µ 2‚Äì3 —á–∞—Å–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏;

–ø—Ä–∏ —Å–±–æ—è—Ö –≤ –æ—Å–Ω–æ–≤–Ω–æ–π –º–æ–¥–µ–ª–∏ –ø–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç—Å—è –Ω–∞ —Ä–µ–∑–µ—Ä–≤–Ω—É—é.